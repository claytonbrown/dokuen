#!/usr/bin/env ruby

$stdout.sync = true

require "rubygems"

begin
  require 'dokuen'
rescue LoadError => e
  path = File.expand_path '../../lib', __FILE__
  $:.unshift(path) if File.directory?(path) && !$:.include?(path)
  require 'dokuen'
end

begin
  Dokuen::Shell.new(ARGV[0], ENV['SSH_ORIGINAL_COMMAND'], ARGV[1]).run()
rescue Dokuen::ExitCode => e
  if e.code != 0
    $stderr.puts e.message
    exit e.code
  end
end
